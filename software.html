<!DOCTYPE html>
<html>
<title>Matthias J. Ehrhardt</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
div.my-anchor {
    display: block;
    position: relative;
    top: -120px;
    visibility: hidden;
}

.my-accordion:hover {
    background-color: #ccc; 
}
	
div.bottom-banner {
	background-image: url(../images/contact_sprite_trans.png);
	background-repeat: no-repeat; 
	background-position: center;
	height: 40px;
	margin-left: auto; 
	margin-right: auto;
	opacity: .5;}

div.bottom-banner:hover {
	opacity: 1;}


div.linkedin{background-position: -40px 0px; width: 40px}
div.linkedin:hover{background-position: 0px 0px;}
div.orcid{background-position: -40px -40px; width: 40px}
div.orcid:hover{background-position: 0px -40px;}
div.researchgate{background-position: -40px -80px; width: 40px}
div.researchgate:hover{background-position: 0px -80px;}
div.google{background-position: -80px -40px; width: 117px}
div.google:hover{background-position: -80px 0px;}
div.github{background-position: -40px -120px; width: 40px}
div.github:hover{background-position: 0px -120px;}


.w3-sidebar a {font-family: "Roboto", sans-serif}
body,h1,h2,h3,h4,h5,h6,.w3-wide {font-family: "Montserrat", sans-serif;}
    
h1 {
    font-size: 18pt;
    font-weight: bold;
    margin: 0em;
}
    
h2 {
    font-size: 14pt;
    font-weight: bold;
    margin: 0em;
}
    
.smallscreen {display: none}
.largescreen {display: block}

@media screen and (max-width: 700px) {
    .smallscreen {display: block}
    .largescreen {display: none}
}
    
</style>

<body>

<!-- Sidebar/menu -->
<div class="w3-top w3-black" style="height: 90px">
  <div class="w3-padding w3-bold w3-xlarge"><a href="index.html" style="text-decoration: none">Matthias J. Ehrhardt</a></div><br>
  <div class="w3-left-align w3-display-bottomleft w3-bar largescreen">
    <a href="index.html#aboutme" class="w3-bar-item w3-button w3-hover-white">About me</a>
    <a href="index.html#group" class="w3-bar-item w3-button w3-hover-white">Group</a>
    <a href="cv.html" class="w3-bar-item w3-button w3-hover-white">CV</a>
    <a href="research.html" class="w3-bar-item w3-button w3-hover-white">Research</a>
    <a href="teaching.html" class="w3-bar-item w3-button w3-hover-white">Teaching</a>
    <a href="software.html" class="w3-bar-item w3-button w3-hover-white">Software</a>
    <a href="index.html#contact" class="w3-bar-item w3-button w3-hover-white">Contact</a>
  </div>
    
  <div class="w3-left-align w3-display-bottomleft w3-bar smallscreen">
    <a href="index.html#aboutme" class="w3-bar-item w3-button w3-hover-white">About me</a>
    <a href="index.html#group" class="w3-bar-item w3-button w3-hover-white">Group</a>
    <a href="research.html" class="w3-bar-item w3-button w3-hover-white">Research</a>
    <a href="index.html#contact" class="w3-bar-item w3-button w3-hover-white">Contact</a>
  </div>
</div>


<!-- !PAGE CONTENT! -->
<div class="w3-main">
<div style="margin-top:90px"></div>

<h1 class="w3-padding">Software</h1>

<h2 class="w3-padding w3-left w3-button my-accordion">Reproducible Research </h2>
	<div class="w3-row-padding">
		<div class="w3-col w3-justify m8 l10">
This page is intended to give access to the software of my published articles. Please feel free to download and make use of it. If you find bugs in our code please let me know: <a href="mailto:m.ehrhardt@bath.ac.uk">m.ehrhardt@bath.ac.uk</a>. 

<p>I not only hope that this page can be useful to you but it also may encourage you to make your research accessible and reproducible. I followed the guideline to <a href="http://reproducibleresearch.net">reproducible research</a> by <a href="http://pixeltje.be/">Patrick Vandewalle</a>.</p>
		</div>

		<div class="w3-col m4 l2">
<a href="http://reproducibleresearch.net"><img src="images/software/Reproducible_Research_149x62.jpg" width="200px"></a>
		</div>
	</div>

<h2 class="w3-padding w3-left w3-button my-accordion">Quick links to all software </h2>
	<div class="w3-padding w3-row-padding">
	<ul style='margin-top:0pt'>
		<li><a href="#MRIMRI">Multi-Contrast MRI Reconstruction with Structure-Guided Total Variation</a></li>
		<li><a href="#PETMRI">Joint reconstruction of PET-MRI by exploiting structural similarity</a></li>	
		<li><a href="#RGB">Vector-Valued Image Processing by Parallel Level Sets</a></li>
		<li><a href="https://github.com/mehrhardt/blind_remote_sensing">Blind Image Fusion for Hyperspectral Imaging with the Directional Total Variation</a></li>
		<li><a href="https://github.com/mehrhardt/spdhg">Stochastic PDHG with Arbitrary Sampling and Imaging Applications</a></li>
		<li><a href="https://github.com/mehrhardt/Enhancing_hMRI">Enhancing the spatial resolution of hyperpolarized carbon‐13 MRI of human brain metabolism using structure guidance</a></li>
	</ul>
	For more software see my <a href="https://github.com/mehrhardt">github</a> page.
	</div>

<!--- MRIMRI --->
<div class="my-anchor" id="MRIMRI"></div><h1 class="w3-padding w3-left w3-button my-accordion"> Multi-Contrast MRI Reconstruction with Structure-Guided Total Variation</h1>
	<div class="w3-row-padding">
		<div class="w3-col w3-justify m5 l5">
<a href="http://www.damtp.cam.ac.uk/user/me404/"><b>M. J. Ehrhardt</b></a>,
<a href="https://www.sites.google.com/site/mbetcke/"><b>M. M. Betcke</b></a> 
<p><b>Paper:</b> [<a href="http://epubs.siam.org/doi/10.1137/15M1047325">SIAM.org</a>] [<a href="https://arxiv.org/abs/1511.06631">arxiv</a>]</p>
<p><b>Download software:</b> [<a href="data/MultiContrastMRI.zip">7 MB</a>]</p>

<p><b>Tested Configurations:</b> The software was tested on Ubuntu 12.04 LTS with Matlab 2015a and Mac OS X with Matlab 2015a.</p>
		</div>
		<div class="w3-col m3 l3">
<img src='images/software/SIAM_MRIMRI/MRIMRI_T1T2.png' height="120px"/> <br> <b>Motivation:</b> Different scan parameters lead to different contrasts in MRI.
		</div>
		<div class="w3-col m4 l4">
<img src='images/software/SIAM_MRIMRI/MRIMRI_structure.png' height="120px"/> <br> <b>Idea:</b> Structure can be either based on the location or direction of edges.
		</div>
	</div>

	<div class="w3-padding">
<b>Reference:</b> M. J. Ehrhardt and M. M. Betcke, <a href="http://epubs.siam.org/doi/10.1137/15M1047325">Multi-Contrast MRI Reconstruction with Structure-Guided Total Variation</a>, SIAM Journal on Imaging Sciences 9(3), pp. 1084–1106, 2016
							
<p><b>Acknowledgements:</b> The simulation results are based on <a href="http://brainweb.bic.mni.mcgill.ca/brainweb/">BrainWeb</a> data and patient data kindly provided by Ninon Burgos and Jonathan Schott from the University College London, UK.</p>

	<div style="width:600px; margin:auto"><img src="images/software/SIAM_MRIMRI/MRIMRI_results.png" width="100%"></div> <br> <b>Example Result:</b> Reconstructions with different a priori knowledge. The reconstruction quality improves visually significantly from left to right.
	</div>



<!--- PETMRI --->
<div class="my-anchor" id="PETMRI"></div><h1 class="w3-padding w3-left w3-button my-accordion">Joint Reconstruction of PET-MRI by Exploiting Structural Similarity</h1>
	<div class="w3-row-padding">
		<div class="w3-threequarter w3-justify">
<a href="http://www.damtp.cam.ac.uk/user/me404/"><b>M. J. Ehrhardt</b></a>,
<a href="https://iris.ucl.ac.uk/iris/browse/profile?upi=KTHIE60"><b>K. Thielemans</b></a>,
<a href="http://www.doc.ic.ac.uk/~lpizarro/Home.html"><b>L. Pizarro</b></a>,
<a href="http://www.ucl.ac.uk/medical-imaging/staff/david_atkinson"><b>D. Atkinson</b></a>,
<a href="http://cmic.cs.ucl.ac.uk/staff/sebastien_ourselin/"><b>S. Ourselin</b></a>,
<a href="https://iris.ucl.ac.uk/iris/browse/profile?upi=BHUTT63"><b>B. F. Hutton</b></a>,
<a href="http://www0.cs.ucl.ac.uk/staff/s.arridge/"><b>S. R. Arridge</b></a>

<p><b>Paper:</b> [<a href="http://dx.doi.org/10.1088/0266-5611/31/1/015001">IOP science</a>]</p>
<p><b>Download software:</b> [<a href="http://iopscience.iop.org/0266-5611/31/1/015001/media/IP_31_1_015001_suppdata_1.zip">59 MB</a>]</p>

<p><b>Tested Configurations:</b> The software was tested on Ubuntu 12.04 LTS with Matlab 2013a.</p>
					
<p><b>Reference:</b> M. J. Ehrhardt, K. Thielemans, L. Pizarro, D. Atkinson, S. Ourselin, B. F. Hutton and S. R. Arridge, <a href="http://dx.doi.org/10.1088/0266-5611/31/1/015001">Joint reconstruction of PET-MRI by exploiting structural similarity</a>, Inverse Problems 31(1), 015001, 2015</p>
		</div>
		<div class="w3-rest">
<img src='images/software/IP_PETMRI/PET.png' height="150px"/><img src='images/software/IP_PETMRI/MRI.png' height="150px"/><br>
<b>Motivation:</b> PET and MRI images show structural similarity due to the same anatomy.	
		</div>

	<div class="w3-padding-small">
<p><b>Acknowledgements:</b> The software uses <i>L-BFGS-B</i> to solve the constrained minimization problem which needs to be downloaded separately. The Fortan code can be obtained from [<a href="http://www.ece.northwestern.edu/~nocedal/lbfgsb.html">link</a>, accessed September 2014] and the Matlab interface from [<a href="http://www.mathworks.co.uk/matlabcentral/fileexchange/35104-lbfgsb--l-bfgs-b--mex-wrapper">link</a>, accessed September 2014].</p>

		<div class="w3-row-padding" style="width:60%; margin:auto">
			<div class="w3-col m3 l3"><img src="images/software/IP_PETMRI/MLEM.png" width="150px"></div>
			<div class="w3-col m3 l3"><img src="images/software/IP_PETMRI/lines2_TV.png" width="150px"></div>
			<div class="w3-col m3 l3"><img src="images/software/IP_PETMRI/lines2_LPLS_PET.png" width="150px"></div>
			<div class="w3-col m3 l3"><img src="images/software/IP_PETMRI/lines2_LPLS_MRI.png" width="150px"></div>
		</div>
		<div class="w3-row-padding" style="width:60%; margin:auto">
			<div class="w3-col m3 l3"><img src="images/software/IP_PETMRI/MLEM_error.png" width="150px"></div>
			<div class="w3-col m3 l3"><img src="images/software/IP_PETMRI/lines2_TV_error.png" width="150px"></div>
			<div class="w3-col m3 l3"><img src="images/software/IP_PETMRI/lines2_LPLS_PET_error.png" width="150px"></div>
			<div class="w3-col m3 l3"><img src="images/software/IP_PETMRI/lines2_LPLS_MRI_error.png" width="150px"></div>
		</div>
<b>Example Result:</b> Reconstructions of simulated PET and undersampled MRI are shown. Separate reconstructions (left) show low resolution in PET and ghosting in MRI. Joint reconstruction (right) results in better defined PET images and removes ghosting artefacts in MRI.
	</div>
	</div>
									
					

<!--- RGB --->
<div class="my-anchor" id="RGB"></div><h1 class="w3-padding w3-left w3-button my-accordion">Vector-Valued Image Processing by Parallel Level Sets</h1>
	<div class="w3-row-padding">
		<div class="w3-col w3-justify m8 l8">
<a href="http://www.damtp.cam.ac.uk/user/me404/"><b>M. J. Ehrhardt</b></a>,
<a href="http://www0.cs.ucl.ac.uk/staff/s.arridge/"><b>S. R. Arridge</b></a>

<p><b>Paper:</b> [<a href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=6576903">IEEE Xplore</a>] [<a href="data/Ehrhardt and Arridge, 2013.pdf">preprint (11 MB)</a>]
</p>
<p><b>Download software:</b> [<a href="data/Parallel Level Sets.rar">14 MB</a>]</p>

<p><b>Tested Configurations:</b> The software was tested on Ubuntu 12.04 LTS with Matlab 2013a.</p>

<p><b>Reference:</b> M. J. Ehrhardt and S. R. Arridge, <a href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=6576903">Vector-Valued Image Processing by Parallel Level Sets </a>, IEEE Transactions on Image Processing, Volume 23, Number 1, Pages 9-18, 2014</p>
		</div>

		<div class="w3-col m4 l4">
			<img src='images/software/TIP_PLS/TIP_shapes.jpg' height="150px"/><br>
			<b>Idea:</b> By penalizing parallel level sets two images evolve to a common shape.
		</div>

		<div class="w3-padding">
			<div class="w3-row-padding w3-padding" style="width:70%; margin:auto">
				<div class="w3-col m4 l4">
<img src="images/software/TIP_PLS/TIP_leopard.jpg" width="240px">
				</div>
				<div class="w3-col m4 l4">
<img src="images/software/TIP_PLS/TIP_leopard_bayer_05.jpg" width="240px">
				</div>
				<div class="w3-col m4 l4">
<img src="images/software/TIP_PLS/TIP_leopard_demosaicking_05_PL.jpg" width="240px">
				</div>
			</div>
<b>Example Result:</b> Demosaicking of the image "leopard" (left) with the noisy data zero filled at missing values (middle). Using parallel level sets one recovers the image visually perfect (right).<br>

<p><b>Acknowledgements:</b> The <i>original images</i> are part of the training data set of the <a href="http://www.eecs.berkeley.edu/Research/Projects/CS/vision/bsds/" target='_blank'>Berkeley Segmentation Dataset</a>, [<a href="http://www.eecs.berkeley.edu/Research/Projects/CS/vision/bsds/BSDS300-images.tgz">download (21 MB)</a>, accessed March 2013]. The images have different names in the data base: leopard = 159029, lake = 176035, pyramid = 299091, bugs = 35008, wolf = 42078. The <i>noisy images</i> can be found on <a href="http://www.cs.utoronto.ca/~strider/Denoise/Benchmark/index.html" target='_blank'>Francisco J. Estrada's web page</a>, [<a href="http://www.cs.utoronto.ca/~strider/Denoise/Benchmark/Denoising_Benchmark.tgz">download (1 GB)</a>, accessed March 2013]. The images have different names on this page: leopard = 0072, lake = 0094, pyramid = 0194, bugs = 0213, wolf = 0246.<br> 
We used the <i>Structural Similarity</i> as a figure of merit. To make use of it in the software please download the file ssim_index.m [<a href="https://ece.uwaterloo.ca/~z70wang/research/ssim/ssim_index.m">download (6 KB)</a>, accessed March 2013] available from the <a href="https://ece.uwaterloo.ca/~z70wang/research/ssim/">author's web page</a>.</p>
		</div>
	</div>


 
<!-- Footer -->
<div class="w3-padding-24 w3-light-grey">
    <div class="w3-content w3-cell-row">
		<div class="w3-cell" style="width: 20%"><a href="http://uk.linkedin.com/pub/matthias-j-ehrhardt/89/193/b61/"><div class="bottom-banner linkedin"> </div></a></div>

		<div class="w3-cell" style="width: 20%"><a href="https://www.researchgate.net/profile/Matthias_Ehrhardt2?ev=hdr_xprf"><div class="bottom-banner researchgate"></div></a></div>

		<div class="w3-cell" style="width: 20%"><a href="http://orcid.org/0000-0001-8523-353X"><div class="bottom-banner orcid"></div></a></div>

		<div class="w3-cell" style="width: 20%"><a href="https://github.com/mehrhardt"><div class="bottom-banner github"></div></a></div>

		<div class="w3-cell" style="width: 20%"><a href="https://scholar.google.co.uk/citations?user=dkbrSccAAAAJ&hl=en"><div class="bottom-banner google"> </div></a></div>
    </div></div>

<div class="w3-black w3-center w3-padding-24">&copy; 2014-2021 Matthias J. Ehrhardt - m.ehrhardt@bath.ac.uk - last updated: 10/2021</div>

<!-- End page content -->
</div>

<script>
var acc = document.getElementsByClassName("my-accordion");
var i;

for (i = 0; i < acc.length; i++) {
    acc[i].addEventListener("click", function() {
        this.classList.toggle("active");
        var panel = this.nextElementSibling;
        if (panel.style.display !== "none") {
            panel.style.display = "none";
        } else {
            panel.style.display = "block";
        }
    });
}
</script>

</body>
</html>

